<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pantry Management</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        table {
            border-collapse: collapse;
            width: 100%;

        }

        th, td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;

        }

        th {
            background-color: #f2f2f2;
        }

        .alert {
            color: red;
        }

        .expiring-soon {
            font-weight: normal;
        }

        /* Rounded corners for textarea */
        textarea {
            border-radius: 5px; /* Adjust the value as needed */
        }
      
      .paste-section h3 {
            margin-bottom: 20px;
        }

       
 input[type="text"] {
            border-radius: 5px; /* Adjust the value as needed */
            width: 20%;
            padding: 10px;
            margin-bottom: 20px;
        }

        .recipe-name-input label,
        .textarea-container label {
            display: block;
            margin-bottom: 10px;
	 border-radius: 5px; 
        }

        .recipe-name-input input,
        #paste-recipe-text {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
        }

        button {
            padding: 10px 20px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <header class="hero">
        <div class="container">
            <div class="logo">
                <img src="C:\Users\Ricar\Desktop\index.html\photos\Savor.png" alt="EcoSavor Solutions Logo">
                <h1>EcoSavor Solutions</h1>
            </div>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="recipes.html">Recipes</a></li>
                    <li><a href="pantry.html">Pantry</a></li>
                    <li><a href="waste.html">Waste Reduction</a></li>
                    <li><a href="community.html">Community</a></li>
                    <li><a href="about.html">About Us</a></li>
                    <li><a href="features.html">Features</a></li>
                    <li><a href="pricing.html">Pricing</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    <li><a href="#" onclick="logout()">Logout</a></li> <!-- Logout link -->
                </ul>
            </nav>
        </div>
    </header>

    <main>
               <section id="recipe-form" class="section">
            <div class="container">
                <h2>Add New Recipe</h2>
                <form id="new-recipe-form" onsubmit="saveRecipe(event)">
                    <label for="recipe-name">Recipe Name:</label>
                    <input type="text" id="recipe-name" name="recipe-name" required>
                    <label for="recipe-description" style="display:block; margin-top: 20px;">Recipe Description:</label>
                    <textarea id="recipe-description" name="recipe-description" rows="10" cols="50" required></textarea>
                    <h3>Ingredients:</h3>
                    <div id="ingredients-list">
                        <!-- Ingredients will be dynamically added here -->
                    </div>
                    <button type="button" onclick="addIngredientField()">Add Ingredient</button>
                    <button type="button" onclick="clearForm()">New</button>
                    <button type="submit">Save Recipe</button>
                </form>
            </div>
        </section>

<section id="saved-recipes" class="section">
    <div class="container">
        <h2>Saved Recipes</h2>
        <table id="recipes-table">
            <thead>
                <tr>
                    <th>Recipe Name</th>
                    <th>Number of Ingredients</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="recipes-list">
                <!-- Saved recipes will be dynamically added here -->
            </tbody>
        </table>
        <style>
            /* Add styles for dividing lines between rows and columns in the saved recipes section */
            #recipes-table {
                border-collapse: collapse;
                width: 100%;
            }

            #recipes-table th,
            #recipes-table td {
                border: 2px solid #ccc; /* Add border to cells */
                padding: 8px;
            }

            #recipes-table th {
                background-color: #f2f2f2; /* Background color for table header */
                text-align: left; /* Align text to the left in header cells */
            }

           #recipes-table th {
                background-color: #f2f2f2; /* Background color for table header */
                text-align: right; /* Align text to the right in header cells */
            }
        </style>
    </div>
</section>

<section id="paste-section" class="section paste-section">
    <div class="container">
        <h2>Paste Existing Recipe</h2>
	<h3> Utilize this feature to paste over existing recipes that you may have saved on your computer or recipes you are interested in from the internet. </h3>
 <div class="recipe-name-input">
            <label for="recipe-name-paste">Recipe Name:</label>
            <input type="text" id="recipe-name-paste" placeholder="Enter Recipe Name">
        </div>
        <div class="textarea-container">
            <textarea id="paste-recipe-text" rows="6" cols="50" placeholder="Paste your recipe here"></textarea>
        </div>
        <button type="button" onclick="parseAndPaste()">Parse Recipe</button>
    </div>
</section>


    </main>
   
 <footer>
        <div class="container">
            <p>&copy; 2024 EcoSavor Solutions. All rights reserved.</p>
            <address>
                123 Main Street, City, Country
            </address>
            <div class="footer-links">
                <a href="#">Terms of Service</a> | 
                <a href="#">Privacy Policy</a>
            </div>
        </div>
    </footer>
   <script>
        function addIngredientField() {
            const ingredientsList = document.getElementById('ingredients-list');
            const newIngredientField = document.createElement('div');
            newIngredientField.innerHTML = `
                <input type="text" name="ingredient-name[]" placeholder="Ingredient Name" required>
                <input type="number" name="ingredient-quantity[]" step="any" placeholder="Quantity" required>
                <select name="ingredient-measurement[]">
                    <option value="Each">Each</option>
                    <option value="cups">Cups</option>
                    <option value="oz">Ounces</option>
                    <option value="grams">Grams</option>
                    <option value="gallons">Gallons</option>
                    <option value="lbs">Pounds</option>
                    <option value="teaspoon">Teaspoon</option>
                    <option value="tablespoon">Tablespoon</option>
                    <!-- Add more measurement options as needed -->
                </select>
                <button type="button" onclick="removeIngredientField(this)">Remove</button>
            `;
            ingredientsList.appendChild(newIngredientField);
        }

        function removeIngredientField(button) {
            const ingredientField = button.parentElement;
            ingredientField.remove();
        }

        function clearForm() {
            document.getElementById('new-recipe-form').reset();
            const ingredientsList = document.getElementById('ingredients-list');
            ingredientsList.innerHTML = '';
        }

        function saveRecipe(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const recipeData = {};
            recipeData['recipe-name'] = formData.get('recipe-name');
            recipeData['recipe-description'] = formData.get('recipe-description');
            recipeData['ingredients'] = [];
            const ingredientNames = formData.getAll('ingredient-name[]');
            const ingredientQuantities = formData.getAll('ingredient-quantity[]');
            const ingredientMeasurements = formData.getAll('ingredient-measurement[]');
            for (let i = 0; i < ingredientNames.length; i++) {
                const ingredient = {
                    name: ingredientNames[i],
                    quantity: ingredientQuantities[i],
                    measurement: ingredientMeasurements[i]
                };
                recipeData['ingredients'].push(ingredient);
            }

            const savedRecipes = JSON.parse(localStorage.getItem('recipes')) || [];
            const recipeIndex = savedRecipes.findIndex(recipe => recipe['recipe-name'] === recipeData['recipe-name']);

            if (recipeIndex !== -1) {
                // Replace the existing recipe with the edited one
                savedRecipes[recipeIndex] = recipeData;
            } else {
                // Add the edited recipe to the end of the list
                savedRecipes.push(recipeData);
            }

            localStorage.setItem('recipes', JSON.stringify(savedRecipes));

            // After saving, reload the recipes
            loadRecipes();

            // Clear the form to refresh it
            clearForm();
        }

        function loadRecipes() {
            const savedRecipes = JSON.parse(localStorage.getItem('recipes')) || [];
            const recipesList = document.getElementById('recipes-list');
            recipesList.innerHTML = '';
            savedRecipes.forEach((recipe, index) => {
                const tr = document.createElement('tr');
                const tdName = document.createElement('td');
                tdName.textContent = recipe['recipe-name'];
                const tdIngredients = document.createElement('td');
                tdIngredients.textContent = recipe['ingredients'].length;
                const tdActions = document.createElement('td');
                const editButton = document.createElement('button');
                editButton.textContent = 'Edit';
                editButton.onclick = () => editRecipe(recipe, index);
                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'Delete';
                deleteButton.onclick = () => deleteRecipe(index);
                tdActions.appendChild(editButton);
                tdActions.appendChild(deleteButton);
                tr.appendChild(tdName);
                tr.appendChild(tdIngredients);
                tr.appendChild(tdActions);
                recipesList.appendChild(tr);
            });
        }

        function editRecipe(recipe, index) {
            // Populate the form with the selected recipe's details for editing
            const recipeNameInput = document.getElementById('recipe-name');
            recipeNameInput.value = recipe['recipe-name'];

            const recipeDescriptionInput = document.getElementById('recipe-description');
            recipeDescriptionInput.value = recipe['recipe-description'];

            const ingredientsList = document.getElementById('ingredients-list');
            ingredientsList.innerHTML = '';
            recipe['ingredients'].forEach(ingredient => {
                const newIngredientField = document.createElement('div');
                newIngredientField.innerHTML = `
                    <input type="text" name="ingredient-name[]" value="${ingredient.name}" required>
                    <input type="number" name="ingredient-quantity[]" step="any" value="${ingredient.quantity}" required>
                    <select name="ingredient-measurement[]">
                        <option value="Each" ${ingredient.measurement === 'Each' ? 'selected' : ''}>Each</option>
                        <option value="cups" ${ingredient.measurement === 'cups' ? 'selected' : ''}>Cups</option>
                        <option value="oz" ${ingredient.measurement === 'oz' ? 'selected' : ''}>Ounces</option>
                        <option value="grams" ${ingredient.measurement === 'grams' ? 'selected' : ''}>Grams</option>
                        <option value="gallons" ${ingredient.measurement === 'gallons' ? 'selected' : ''}>Gallons</option>
                        <option value="lbs" ${ingredient.measurement === 'lbs' ? 'selected' : ''}>Pounds</option>
                        <option value="teaspoon" ${ingredient.measurement === 'teaspoon' ? 'selected' : ''}>Teaspoon</option>
                        <option value="tablespoon" ${ingredient.measurement === 'tablespoon' ? 'selected' : ''}>Tablespoon</option>
                        <!-- Add more measurement options as needed -->
                    </select>
                    <button type="button" onclick="removeIngredientField(this)">Remove</button>
                `;
                ingredientsList.appendChild(newIngredientField);
            });
        }

        function deleteRecipe(index) {
            const savedRecipes = JSON.parse(localStorage.getItem('recipes')) || [];
            savedRecipes.splice(index, 1);
            localStorage.setItem('recipes', JSON.stringify(savedRecipes));
            loadRecipes();
        }

        // Load saved recipes when the page loads
        window.onload = function() {
            loadRecipes();
        };

        function parseAndPaste() {
            const recipeText = document.getElementById('paste-recipe-text').value.trim();
            const lines = recipeText.split('\n').filter(line => line.trim() !== '');

            // Extract recipe name and ingredients
            const recipeName = lines[0];
            const ingredients = lines.slice(1);

            // Populate form fields with parsed recipe data
            document.getElementById('recipe-name').value = recipeName;

            // Clear previous ingredient fields
            const ingredientsList = document.getElementById('ingredients-list');
            ingredientsList.innerHTML = '';

            // Add new ingredient fields with parsed ingredients
            ingredients.forEach(ingredientLine => {
                // Regex pattern to match quantities with fractions and tenths of a decimal
                const quantityRegex = /^(\d+(\.\d+)?|(\d+\s)?\d+\/\d+)$/;

                // Extracting quantity and name parts from the ingredient line
                const parts = ingredientLine.split(' ');
                let quantityStr = '';
                let nameParts = [];

                // Loop through each part to find the quantity and name parts
                for (const part of parts) {
                    if (quantityRegex.test(part) || !isNaN(part)) {
                        // If the part is a number or matches the quantity regex, it's the quantity
                        quantityStr += part + ' ';
                    } else {
                        // If it's not a number, it's part of the ingredient name
                        nameParts.push(part);
                    }
                }

                // Convert the quantity string to a number
                const quantity = eval(quantityStr.trim());

                // Join the name parts to form the ingredient name
                const name = nameParts.join(' ');

                // Look for known measurement units in the name
                const knownUnits = ['cups', 'oz', 'grams', 'gallons', 'lbs', 'teaspoon', 'tablespoon'];
                let measurement = 'Each'; // Default measurement
                for (const unit of knownUnits) {
                    if (name.includes(unit)) {
                        measurement = unit;
                        break;
                    }
                }

                // Create new ingredient field
                const newIngredientField = document.createElement('div');
                newIngredientField.innerHTML = `
                    <input type="text" name="ingredient-name[]" value="${name}" required>
                    <input type="number" name="ingredient-quantity[]" step="any" value="${quantity}" required>
                    <select name="ingredient-measurement[]">
                        <option value="Each" ${measurement === 'Each' ? 'selected' : ''}>Each</option>
                        <option value="cups" ${measurement === 'cups' ? 'selected' : ''}>Cups</option>
                        <option value="oz" ${measurement === 'oz' ? 'selected' : ''}>Ounces</option>
                        <option value="grams" ${measurement === 'grams' ? 'selected' : ''}>Grams</option>
                        <option value="gallons" ${measurement === 'gallons' ? 'selected' : ''}>Gallons</option>
                        <option value="lbs" ${measurement === 'lbs' ? 'selected' : ''}>Pounds</option>
                        <option value="teaspoon" ${measurement === 'teaspoon' ? 'selected' : ''}>Teaspoon</option>
                        <option value="tablespoon" ${measurement === 'tablespoon' ? 'selected' : ''}>Tablespoon</option>
                        <!-- Add more measurement options as needed -->
                    </select>
                    <button type="button" onclick="removeIngredientField(this)">Remove</button>
                `;
                ingredientsList.appendChild(newIngredientField);
            });
        }
function logout() {
            // Add logout logic here (e.g., clear session data or redirect to login page)
            // For demonstration, redirect to login page after 1 second
            setTimeout(() => {
                window.location.href = "login.html"; // Redirect to login page
            }, 1000);
        }
    </script>
</body>
</html>
